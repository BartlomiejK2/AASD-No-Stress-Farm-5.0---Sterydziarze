version: '3.8'

services:
  server_hello:
    image: tigase/tigase-xmpp-server:8.0.0
    container_name: server_hello
    ports:
      - "8480:8080"   # panel HTTP
      - "5422:5222"   # XMPP na hosta, ale wewnÄ…trz sieci dalej 5222
    environment:
      - DB_ROOT_USER=admin
      - DB_ROOT_PASS=admin
      - ADMIN_JID=admin@server_hello
      - ADMIN_PASSWORD=admin
    volumes:
      - ./tigase/config/tigase.conf:/home/tigase/tigase-server/etc/tigase.conf
      - ./tigase/config/config.tdsl:/home/tigase/tigase-server/etc/config.tdsl

  spade_hello:
    build: .                # <- zamiast image: spade_hello:latest
    container_name: spade_hello
    depends_on:
      - server_hello
    environment:
      - SPADE_JID=agent@server_hello
      - SPADE_PASSWORD=secret
      - XMPP_HOST=server_hello